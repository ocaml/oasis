<!--- OASIS_START --->
<!--- DO NOT EDIT (digest: fa5b2e44255b14951d927b0e054fa38f) --->

oasis - Tooling for building OCaml libraries and applications
=============================================================

[![Travis-CI Build Status](https://travis-ci.org/ocaml/oasis.svg?branch=master)](https://travis-ci.org/ocaml/oasis)
[![AppVeyor Build status](https://ci.appveyor.com/api/projects/status/42gumiqt5le643t2?svg=true)](https://ci.appveyor.com/project/gildor478/oasis)
[![Join the chat at https://gitter.im/ocaml/oasis](https://badges.gitter.im/ocaml/oasis.svg)](https://gitter.im/ocaml/oasis?utm_source=badge&utm_medium=badge&utm_campaign=pr-badge&utm_content=badge)

OASIS generates a full configure, build and install system for your
application. It starts with a simple `_oasis` file at the toplevel of your
project and creates everything required.

OASIS leverages existing OCaml tooling to perform most of it's work. In fact,
it might be more appropriate to think of it as simply the glue that binds
these other subsystems together and coordinates the work that they do. It
should support the following tools:

 * OCamlbuild
 * OMake
 * OCamlMakefile (todo),
 * ocaml-autoconf (todo)

It also features a do-it-yourself command line invocation and an internal
configure/install scheme. Libraries are managed through findlib. It has been
tested on GNU Linux and Windows.

It also allows to have standard entry points and description. It helps to
integrates your libraries and software with third parties tools like OPAM.

See the file [INSTALL.md](INSTALL.md) for building and installation
instructions.

[Home page](http://oasis.forge.ocamlcore.org/)

[Bug reports](https://github.com/ocaml/oasis/issues)

Copyright and license
---------------------

(C) 2011-2016 Sylvain Le Gall
(C) 2008-2010 OCamlCore SARL

oasis is distributed under the terms of the GNU Lesser General Public License
version 2.1 with OCaml linking exception.

See [COPYING.txt](COPYING.txt) for more information.

<!--- OASIS_STOP --->

Related documentation
---------------------

[OMake README](src/plugins/omake/README.md)


Migration to dune
-----------------

As of 2019-09-25, OASIS is no more considered under active development. We
recommend to migrate to [dune] and use [opam] files for publishing your package
on OPAM. These two tools work well together as a replacement for OASIS. We have
tested them into various configuration (Windows, Linux, Mac OSX) and they were
working better than OASIS + ocamlbuild, with faster build on Windows at least. 

[dune]: https://dune.readthedocs.io/en/latest/
[opam]: https://opam.ocaml.org

Here is a step by step guide to migrate to dune from OASIS. The goal is to help
you to convert your _oasis file to dune, but this guide is in no way
exhaustive. Consider reading the [dune] doc to learn more.

* Run "ocaml setup.ml -distclean" to remove most files generated by OASIS.
* Additionaly remove the following files:
  * .merlin which is autogenerated by dune.
  * _oasis
  * configure
  * _tags (ocamlbuild related)
  * myocamlbuild.ml (ocamlbuild related)
  * setup.ml
  * .mllib, .mldylib, .clib META?
* Add to .gitignore the following files:
  * .merlin
  * *.install (opam file generated by dune)
* Remove from .gitignore:
  * setup.data
  * setup.log
  * _build, *.byte and other ocamlbuild specific files
* Remove oasis, ocamlbuild and ocamlfind from any *.opam files and add the
  following:

```
build: [
  ["dune" "build" "-p" name "-j" jobs]
  ["dune" "build" "@doc" "-p" name "-j" jobs] {with-doc}
  ["dune" "runtest" "-p" name "-j" jobs] {with-test}
]
build-doc: 
build-test: 
depends: [
  "dune" {>= "1.11.0"}
]
```

* Inside your Makefile (if you have one), replace the OASIS_START, OASIS_STOP section by:

```makefile
build:
    dune build

clean:
    dune clean

doc:
    dune build @doc
```

* Add a dune-project file:

```
(lang dune 1.11)
(name myproject)
(explicit_js_mode)
```

* We recommend to group executables, tests and libraries in their own
  directories. This help to write smaller dune files. 

* Converting a library

_oasis definition:
```
 Library "oUnitThreads"
  Path: src/lib/ounit/threads
  Modules: OUnitThreads
  InternalModules: OUnitRunnerThreads
  BuildDepends: threads, ounit
  FindlibParent: ounit
  FindlibName: threads
```

dune file in src/lib/ounit/threads (along with the sources):
```
(library
  (name oUnitThreads)
  (public_name ounit.threads)
  (private_modules oUnitRunnerThreads)
  (libraries threads ounit))
```

* Converting an executable

_oasis definition:
```
Executable fakeExec
  Path:   src/bin/fakeExec
  MainIs: fakeExec.ml
  BuildDepends: cmdliner
```

dune file in src/bin/fakeExec/ (along with the sources):
```
(executable
  (name fakeExec)
  (public_name fakeExec)
  (libraries cmdliner))
```

* Converting a test

_oasis definition:
```
Executable test
  Path:   test
  MainIs: test.ml
  BuildDepends: ounit2, ounit2.advanced, str
  Install: false
  Build$: flag(tests)

Test main
  Command: $test -xmllint $xmllint \
    -testFakeHTML $testfakehtml \
    -testFakeRunner $testfakerunner \
    -testFakeShared $testfakeshared
  TestTools: test, testFakeHTML, testFakeRunner, xmllint
```

dune file in test/ (along with the sources):
```
(test                                                                           
  (name test)                                                                   
  (libraries ounit2 ounit2.advanced str testcommon)
  (deps                                                                         
    test.exe                                                                    
    fakeHTML/fakeHTML.exe                                                       
    fakeRunner/fakeRunner.exe                                                   
    fakeShared/fakeShared.exe                                                   
    fakeBadFinaliser/fakeBadFinaliser.exe                                       
    JUnit.xsd)                                                                  
  (action                                                                       
    (run %{test}                                                                
      -fakeHTML ./fakeHTML/fakeHTML.exe                                         
      -fakeRunner ./fakeRunner/fakeRunner.exe                                   
      -fakeShared ./fakeShared/fakeShared.exe                                   
      -fakeBadFinaliser ./fakeBadFinaliser/fakeBadFinaliser.exe)))
```
